
:root{
  --ink:#0f172a;--muted:#475569;--bg:#ffffff;--bg-2:#f8fafc;--brand:#0ea5a3;--brand-2:#2563eb;
  --border:#e2e8f0;--ring:rgba(37,99,235,.2);
  --measure: 72ch;
  --fs-1: clamp(28px,4.6vw,44px);
  --fs-2: clamp(22px,3.2vw,30px);
  --fs-3: clamp(18px,2.4vw,22px);
  --radius: 16px;
}
html[data-theme="dark"]{
  --ink:#e5e7eb;--muted:#94a3b8;--bg:#0b1220;--bg-2:#0f172a;--border:#1f2a44;--ring:rgba(14,165,233,.25);
}
*{box-sizing:border-box}
html,body{margin:0;height:100%}
body{font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;color:var(--ink);background:var(--bg);line-height:1.78}
a{color:inherit}
.container{max-width:1100px;margin:0 auto;padding:0 18px}
.prose{max-width:var(--measure); margin:0 auto}
.prose p{margin:1em 0}
.prose h1{font-size:var(--fs-1); line-height:1.12; margin:.2em 0 .4em; letter-spacing:-.01em}
.prose h2{font-size:var(--fs-2); line-height:1.18; margin:1.6em 0 .6em}
.prose h3{font-size:var(--fs-3); line-height:1.26; margin:1.2em 0 .4em}
.prose a{ text-decoration: underline; text-underline-offset: 3px; text-decoration-color: rgba(37,99,235,.5)}
.prose ul, .prose ol{padding-left:1.2em; margin:.8em 0}
.prose li{margin:.35em 0}
.prose blockquote{border-left:4px solid var(--brand-2); padding:.4em 1em; margin:1em 0; background:color-mix(in oklab, var(--brand-2) 8%, transparent)}
.prose img{max-width:100%; border-radius:12px}
.kicker{display:inline-block;font-weight:800;color:var(--brand);text-transform:uppercase;letter-spacing:.06em;font-size:12px}

/* Header / nav */
.skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
.skip-link:focus{left:10px;top:10px;width:auto;height:auto;background:#fff;color:#111;padding:8px 12px;border-radius:10px;z-index:1000}
.site-header{position:sticky;top:0;background:var(--bg);border-bottom:1px solid var(--border);z-index:60;backdrop-filter:saturate(150%) blur(4px)}
.site-header .nav-wrap{position:relative}position:sticky;top:0;background:var(--bg);border-bottom:1px solid var(--border);z-index:60;backdrop-filter:saturate(150%) blur(4px)}
.nav-wrap{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 0}
.brand{display:flex;align-items:center;gap:10px;font-weight:900;text-decoration:none;white-space:nowrap}
.nav{display:flex;gap:10px;align-items:center}
.nav a{padding:8px 10px;border-radius:10px;text-decoration:none;color:var(--ink);white-space:nowrap}
.nav a:hover{background:var(--bg-2)}
.nav-toggle,.theme-toggle{display:none;border:1px solid var(--border);background:var(--bg);border-radius:999px;padding:8px 12px}
.nav-ctrls{display:flex;gap:8px;align-items:center}

/* Hero */
.hero{background:linear-gradient(90deg,rgba(14,165,163,.08),rgba(37,99,235,.08));border-bottom:1px solid var(--border)}
.hero .container{display:grid;grid-template-columns:1.15fr 1fr;gap:22px;padding:28px 18px;align-items:start}
.hero .card.prose{margin:0}

/* Article with sticky TOC */
.article{display:grid; grid-template-columns: 260px 1fr; gap:24px; align-items:start; padding:22px 18px}
.toc{position:sticky; top:80px; max-height: calc(100dvh - 96px); overflow:auto; border:1px solid var(--border); border-radius:var(--radius); padding:12px; background:var(--bg-2)}
.toc h3{margin:0 0 8px; font-size:14px; color:var(--muted)}
.toc a{display:block; padding:6px 8px; border-radius:10px; text-decoration:none; color:var(--muted)}
.toc a.active{background:color-mix(in oklab, var(--brand-2) 16%, transparent); color:var(--ink)}
.card{background:var(--bg); border:1px solid var(--border); border-radius:var(--radius); padding:16px; box-shadow:0 1px 0 var(--border)}

/* Timeline */
.timeline{position:relative;padding-left:22px}
.timeline:before{content:"";position:absolute;left:10px;top:0;bottom:0;width:2px;background:linear-gradient(var(--brand),var(--brand-2))}
.tl-item{position:relative;margin:6px 0 16px}
.tl-item:before{content:"";position:absolute;left:-14px;top:.4em;width:10px;height:10px;background:var(--brand);border-radius:50%;box-shadow:0 0 0 4px var(--ring)}
.badge{background:rgba(14,165,163,.12);color:#0b766b;border:1px solid rgba(14,165,163,.25);padding:4px 10px;border-radius:999px;font-size:12px}

/* Footer */
.site-footer{margin-top:28px;border-top:1px solid var(--border);background:var(--bg)}
.site-footer .grid{display:grid;gap:18px;grid-template-columns:1.2fr 1fr 1fr;padding:18px 0}
.site-footer h4{margin:0 0 6px}
.legal{text-align:center;color:var(--muted);font-size:12px;padding:12px 0}

/* Reading progress */
.reading-progress{position:sticky; top:0; height:4px; background:transparent; z-index:70}
.reading-progress span{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--brand),var(--brand-2))}

/* Prev/Next */
.pager{display:flex; justify-content:space-between; gap:16px; padding:20px 18px; border-top:1px solid var(--border); margin-top:8px}
.pager a{flex:1; text-decoration:none}
.pager a > div{border:1px solid var(--border); border-radius:12px; padding:12px}
.pager small{display:block; color:var(--muted)}

/* Mobile */

@media (max-width: 980px){
  .hero .container{grid-template-columns:1fr; gap:16px; padding:20px 16px}
  .article{grid-template-columns: 1fr; padding:18px 16px}
  .toc{position:relative; top:auto; max-height:none; margin-bottom:12px}
  .nav{display:none; position:absolute; top:100%; left:0; width:100%; background:var(--bg); border-top:1px solid var(--border); 
       flex-direction:column; align-items:flex-start; padding:12px 18px; gap:0; box-shadow:0 6px 14px rgba(0,0,0,.06)}
  .nav.show{display:flex; animation:fadeIn .18s ease-out}
  .nav a{width:100%; padding:12px 0; border-bottom:1px solid var(--border)}
  .nav a:last-child{border-bottom:0}
  .nav-toggle,.theme-toggle{display:inline-block}
  .site-footer .grid{grid-template-columns:1fr; padding:16px 16px}
}
@keyframes fadeIn{from{opacity:0; transform:translateY(-6px)} to{opacity:1; transform:translateY(0)}}
.article{grid-template-columns: 1fr; padding:18px 16px}
  .toc{position:relative; top:auto; max-height:none; margin-bottom:12px}
  .nav{display:none;flex-direction:column;align-items:flex-start;padding:10px 0; gap:6px}
  .nav.show{display:flex}
  .nav a{padding:10px 12px}
  .nav-toggle,.theme-toggle{display:inline-block}
  .site-footer .grid{grid-template-columns:1fr; padding:16px 16px}
}

.hero .placeholder{
  aspect-ratio: 16/10;
  border-radius: 16px;
  border:1px solid var(--border);
  background: linear-gradient(135deg, rgba(14,165,163,.12), rgba(37,99,235,.12));
}
/* Scroll reveal */
.reveal{opacity:0; transform: translateY(14px); transition: all .45s ease}
.reveal.in{opacity:1; transform:none}

/* ===== Desktop polish ===== */
@media (min-width: 981px){
  .site-header{box-shadow:0 1px 0 var(--border)}
  .hero{background:linear-gradient(180deg, rgba(14,165,163,.06), rgba(37,99,235,.06));}
  .hero .container{
    grid-template-columns: 1.25fr .9fr;
    align-items: center;
    padding: 56px 24px;
    gap: 36px;
  }
  .hero .prose:first-child{max-width: 60ch}
  .hero .card.prose{max-width: 46ch; margin-left:auto}
  .hero h1{letter-spacing:-.012em}
}
/* Slightly softer card look on desktop */
.card{box-shadow: 0 1px 0 var(--border), 0 8px 24px rgba(0,0,0,.03)}

/* ===== Footer redesign ===== */
.site-footer{
  margin-top:48px;
  background: var(--bg-2);
  border-top: 1px solid var(--border);
}
.site-footer .grid{
  display:grid;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap: 28px;
  align-items:start;
  padding: 28px 0;
}
.site-footer strong{font-size:18px}
.site-footer p{margin:.5em 0 0; color: var(--muted)}
.site-footer h4{font-size:14px; letter-spacing:.02em; text-transform:uppercase; color: var(--muted); margin:0 0 8px}
.site-footer ul{list-style:none; padding:0; margin:0}
.site-footer li{margin:.35em 0}
.site-footer a{text-decoration:none; color: var(--muted)}
.site-footer a:hover{color: var(--ink); text-decoration: underline; text-underline-offset: 3px}
.legal{border-top:1px solid var(--border); margin-top:8px; padding:14px 0; text-align:center; color:var(--muted); font-size:12px}

/* Footer mobile */
@media (max-width: 980px){
  .site-footer .grid{grid-template-columns:1fr; text-align:center; padding:22px 0}
  .site-footer .grid > div{max-width:520px; margin:0 auto}
}

/* Header tighten */
@media (min-width: 981px){
  .nav-wrap{padding:12px 0}
  .nav a{padding:10px 12px}
}
